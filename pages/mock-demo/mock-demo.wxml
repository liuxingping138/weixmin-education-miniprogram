<!--pages/mock-demo/mock-demo.wxml-->
<view class="container">
  <view class="header">
    <text class="title">Mock数据系统演示</text>
    <view class="status">
      <text class="status-text">Mock状态: </text>
      <text class="status-value {{mockEnabled ? 'enabled' : 'disabled'}}">
        {{mockEnabled ? '已启用' : '已禁用'}}
      </text>
    </view>
  </view>

  <view class="controls">
    <button class="btn-toggle {{mockEnabled ? 'enabled' : 'disabled'}}" 
            bindtap="toggleMock">
      {{mockEnabled ? '禁用Mock' : '启用Mock'}}
    </button>
    
    <button class="btn-test" 
            bindtap="testAllAPIs" 
            loading="{{loading}}"
            disabled="{{!mockEnabled}}">
      测试所有API
    </button>
    
    <button class="btn-clear" 
            bindtap="clearResults"
            disabled="{{testResults.length === 0}}">
      清空结果
    </button>
  </view>

  <view class="quick-tests">
    <text class="section-title">快速测试</text>
    <view class="test-buttons">
      <button class="btn-quick" 
              data-api="login" 
              data-name="用户登录"
              bindtap="testSingleAPI"
              disabled="{{!mockEnabled || loading}}">
        登录
      </button>
      <button class="btn-quick" 
              data-api="classList" 
              data-name="班级列表"
              bindtap="testSingleAPI"
              disabled="{{!mockEnabled || loading}}">
        班级
      </button>
      <button class="btn-quick" 
              data-api="homeworkList" 
              data-name="作业列表"
              bindtap="testSingleAPI"
              disabled="{{!mockEnabled || loading}}">
        作业
      </button>
      <button class="btn-quick" 
              data-api="pointsHistory" 
              data-name="积分记录"
              bindtap="testSingleAPI"
              disabled="{{!mockEnabled || loading}}">
        积分
      </button>
    </view>
  </view>

  <view class="results" wx:if="{{testResults.length > 0}}">
    <text class="section-title">测试结果</text>
    <view class="result-list">
      <view class="result-item {{item.status}}" 
            wx:for="{{testResults}}" 
            wx:key="name"
            data-index="{{index}}"
            bindtap="viewDetail">
        <view class="result-header">
          <text class="result-name">{{item.name}}</text>
          <text class="result-time">{{item.time}}</text>
        </view>
        <view class="result-status">
          <text class="status-icon">{{item.status === 'success' ? '✓' : '✗'}}</text>
          <text class="status-text">{{item.status === 'success' ? '成功' : '失败'}}</text>
        </view>
      </view>
    </view>
  </view>

  <view class="empty" wx:if="{{testResults.length === 0 && !loading}}">
    <text class="empty-text">暂无测试结果</text>
    <text class="empty-tip">点击上方按钮开始测试</text>
  </view>

  <view class="loading" wx:if="{{loading}}">
    <text class="loading-text">测试中...</text>
  </view>
</view>