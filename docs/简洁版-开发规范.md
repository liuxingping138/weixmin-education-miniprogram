# ç½‘ç»œæ•™å­¦ç­çº§ç®¡ç†å¹³å° - å¼€å‘è§„èŒƒ

## ğŸ“‹ ä»£ç è§„èŒƒ

### æ–‡ä»¶å‘½åè§„èŒƒ

#### é¡µé¢æ–‡ä»¶å‘½å
```
pages/
â”œâ”€â”€ dashboard/           # æ¦‚è§ˆé¡µ (kebab-case)
â”œâ”€â”€ students/           # å­¦ç”Ÿç®¡ç†é¡µ
â”œâ”€â”€ student-detail/     # å­¦ç”Ÿè¯¦æƒ…é¡µ
â”œâ”€â”€ tags/              # æ ‡ç­¾ç®¡ç†é¡µ
â””â”€â”€ profile/           # ä¸ªäººä¸­å¿ƒé¡µ
```

#### ç»„ä»¶æ–‡ä»¶å‘½å
```
components/
â”œâ”€â”€ student-card/       # å­¦ç”Ÿå¡ç‰‡ç»„ä»¶ (kebab-case)
â”œâ”€â”€ tag-selector/       # æ ‡ç­¾é€‰æ‹©å™¨ç»„ä»¶
â”œâ”€â”€ stats-card/         # ç»Ÿè®¡å¡ç‰‡ç»„ä»¶
â””â”€â”€ action-sheet/       # æ“ä½œé¢æ¿ç»„ä»¶
```

#### å·¥å…·æ–‡ä»¶å‘½å
```
utils/
â”œâ”€â”€ data-manager.js     # æ•°æ®ç®¡ç† (kebab-case + .js)
â”œâ”€â”€ tag-utils.js        # æ ‡ç­¾å·¥å…·
â”œâ”€â”€ storage-utils.js    # å­˜å‚¨å·¥å…·
â””â”€â”€ common-utils.js     # é€šç”¨å·¥å…·
```

### JavaScript ä»£ç è§„èŒƒ

#### å˜é‡å‘½å
```javascript
// ä½¿ç”¨ camelCase å‘½åå˜é‡å’Œå‡½æ•°
const studentList = []
const tagManager = new TagManager()

// ä½¿ç”¨ PascalCase å‘½åç±»å’Œæ„é€ å‡½æ•°
class StudentManager {
  constructor() {}
}

// ä½¿ç”¨ UPPER_SNAKE_CASE å‘½åå¸¸é‡
const STORAGE_KEYS = {
  STUDENTS: 'students_data',
  TAGS: 'tags_data'
}

// ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡å
const activeStudentCount = students.filter(s => s.status === 'active').length
// é¿å…ä½¿ç”¨æ— æ„ä¹‰çš„å˜é‡å
// const count = students.filter(s => s.status === 'active').length
```

#### å‡½æ•°è§„èŒƒ
```javascript
// å‡½æ•°åä½¿ç”¨åŠ¨è¯å¼€å¤´ï¼Œæè¿°åŠŸèƒ½
function getStudentById(id) {
  return students.find(student => student.id === id)
}

function updateStudentTags(studentId, tags) {
  // å‡½æ•°ä½“ä¸è¶…è¿‡ 20 è¡Œ
  const student = getStudentById(studentId)
  if (!student) {
    throw new Error('Student not found')
  }
  
  student.tags = tags
  student.updateTime = new Date().toISOString()
  
  return saveStudent(student)
}

// ä½¿ç”¨ JSDoc æ³¨é‡Š
/**
 * ä¸ºå­¦ç”Ÿæ·»åŠ æ ‡ç­¾
 * @param {string} studentId - å­¦ç”ŸID
 * @param {string} tagId - æ ‡ç­¾ID
 * @returns {boolean} æ˜¯å¦æ·»åŠ æˆåŠŸ
 */
function addTagToStudent(studentId, tagId) {
  // å®ç°é€»è¾‘
}
```

#### å¯¹è±¡å’Œæ•°ç»„æ“ä½œ
```javascript
// ä½¿ç”¨è§£æ„èµ‹å€¼
const { name, grade, tags } = student
const [firstTag, ...otherTags] = student.tags

// ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦
const newStudent = { ...student, updateTime: new Date() }
const allTags = [...systemTags, ...customTags]

// ä½¿ç”¨æ•°ç»„æ–¹æ³•è€Œéå¾ªç¯
const activeStudents = students.filter(s => s.status === 'active')
const studentNames = students.map(s => s.name)
const hasActiveStudent = students.some(s => s.status === 'active')
```

#### å¼‚æ­¥å¤„ç†
```javascript
// ä½¿ç”¨ async/await è€Œé Promise.then
async function loadStudentData() {
  try {
    const data = await StorageUtils.get(STORAGE_KEYS.STUDENTS)
    return data || []
  } catch (error) {
    console.error('åŠ è½½å­¦ç”Ÿæ•°æ®å¤±è´¥:', error)
    return []
  }
}

// é”™è¯¯å¤„ç†
async function saveStudent(student) {
  try {
    await StorageUtils.set(STORAGE_KEYS.STUDENTS, students)
    return { success: true }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

### WXML æ¨¡æ¿è§„èŒƒ

#### æ ‡ç­¾å’Œå±æ€§
```xml
<!-- ä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾ -->
<view class="student-card">
  <text class="student-name">{{student.name}}</text>
  <text class="student-grade">{{student.grade}}</text>
</view>

<!-- å±æ€§ä½¿ç”¨åŒå¼•å·ï¼ŒæŒ‰å­—æ¯é¡ºåºæ’åˆ— -->
<button 
  bindtap="onAddStudent"
  class="btn btn-primary"
  type="primary"
>
  æ·»åŠ å­¦ç”Ÿ
</button>

<!-- æ¡ä»¶æ¸²æŸ“ä½¿ç”¨ wx:if -->
<view wx:if="{{students.length > 0}}" class="student-list">
  <!-- å­¦ç”Ÿåˆ—è¡¨ -->
</view>
<view wx:else class="empty-state">
  <text>æš‚æ— å­¦ç”Ÿæ•°æ®</text>
</view>

<!-- åˆ—è¡¨æ¸²æŸ“ -->
<view 
  wx:for="{{students}}" 
  wx:key="id"
  wx:for-item="student"
  class="student-item"
>
  <text>{{student.name}}</text>
</view>
```

#### äº‹ä»¶å¤„ç†
```xml
<!-- äº‹ä»¶åä½¿ç”¨ on å‰ç¼€ -->
<button bindtap="onAddStudent">æ·»åŠ </button>
<input bindinput="onSearchInput" placeholder="æœç´¢å­¦ç”Ÿ" />
<picker bindchange="onTagChange" range="{{tagList}}">é€‰æ‹©æ ‡ç­¾</picker>

<!-- ä¼ é€’å‚æ•°ä½¿ç”¨ data-* å±æ€§ -->
<button 
  bindtap="onDeleteStudent"
  data-student-id="{{student.id}}"
>
  åˆ é™¤
</button>
```

### WXSS æ ·å¼è§„èŒƒ

#### é€‰æ‹©å™¨å‘½å
```css
/* ä½¿ç”¨ BEM å‘½åè§„èŒƒ */
.student-card {
  /* å— (Block) */
}

.student-card__name {
  /* å…ƒç´  (Element) */
}

.student-card--active {
  /* ä¿®é¥°ç¬¦ (Modifier) */
}

.student-card__tag--primary {
  /* å…ƒç´ çš„ä¿®é¥°ç¬¦ */
}
```

#### æ ·å¼ç»„ç»‡
```css
/* 1. å¸ƒå±€å±æ€§ */
.student-card {
  display: flex;
  flex-direction: column;
  position: relative;
  
  /* 2. ç›’æ¨¡å‹å±æ€§ */
  width: 100%;
  height: auto;
  padding: 30rpx;
  margin-bottom: 20rpx;
  border-radius: 16rpx;
  
  /* 3. è§†è§‰å±æ€§ */
  background-color: #ffffff;
  box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.08);
  
  /* 4. å­—ä½“å±æ€§ */
  font-size: 28rpx;
  color: #333333;
  
  /* 5. å…¶ä»–å±æ€§ */
  transition: all 0.3s ease;
}
```

#### å“åº”å¼è®¾è®¡
```css
/* ä½¿ç”¨ rpx å•ä½ */
.container {
  padding: 20rpx;
  font-size: 28rpx; /* 16px */
}

/* åª’ä½“æŸ¥è¯¢ */
@media (max-width: 750rpx) {
  .student-grid {
    grid-template-columns: 1fr;
  }
}

@media (min-width: 751rpx) {
  .student-grid {
    grid-template-columns: 1fr 1fr;
  }
}
```

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„è§„èŒƒ

### ç›®å½•ç»“æ„
```
frontend/
â”œâ”€â”€ app.js                 # åº”ç”¨å…¥å£
â”œâ”€â”€ app.json              # åº”ç”¨é…ç½®
â”œâ”€â”€ app.wxss              # å…¨å±€æ ·å¼
â”œâ”€â”€ sitemap.json          # ç«™ç‚¹åœ°å›¾
â”œâ”€â”€ project.config.json   # é¡¹ç›®é…ç½®
â”œâ”€â”€ pages/                # é¡µé¢ç›®å½•
â”‚   â”œâ”€â”€ dashboard/        # æ¦‚è§ˆé¡µ
â”‚   â”œâ”€â”€ students/         # å­¦ç”Ÿç®¡ç†
â”‚   â”œâ”€â”€ student-detail/   # å­¦ç”Ÿè¯¦æƒ…
â”‚   â”œâ”€â”€ tags/            # æ ‡ç­¾ç®¡ç†
â”‚   â””â”€â”€ profile/         # ä¸ªäººä¸­å¿ƒ
â”œâ”€â”€ components/          # è‡ªå®šä¹‰ç»„ä»¶
â”‚   â”œâ”€â”€ student-card/    # å­¦ç”Ÿå¡ç‰‡
â”‚   â”œâ”€â”€ tag-selector/    # æ ‡ç­¾é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ stats-card/      # ç»Ÿè®¡å¡ç‰‡
â”‚   â””â”€â”€ action-sheet/    # æ“ä½œé¢æ¿
â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ data-manager.js  # æ•°æ®ç®¡ç†
â”‚   â”œâ”€â”€ tag-utils.js     # æ ‡ç­¾å·¥å…·
â”‚   â”œâ”€â”€ storage-utils.js # å­˜å‚¨å·¥å…·
â”‚   â””â”€â”€ common-utils.js  # é€šç”¨å·¥å…·
â”œâ”€â”€ data/                # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ mock-students.js # å­¦ç”Ÿæ•°æ®
â”‚   â”œâ”€â”€ mock-tags.js     # æ ‡ç­¾æ•°æ®
â”‚   â””â”€â”€ constants.js     # å¸¸é‡å®šä¹‰
â””â”€â”€ images/              # å›¾ç‰‡èµ„æº
    â”œâ”€â”€ icons/           # å›¾æ ‡
    â””â”€â”€ avatars/         # å¤´åƒ
```

### é¡µé¢æ–‡ä»¶ç»“æ„
```
pages/students/
â”œâ”€â”€ students.js          # é¡µé¢é€»è¾‘
â”œâ”€â”€ students.json        # é¡µé¢é…ç½®
â”œâ”€â”€ students.wxml        # é¡µé¢ç»“æ„
â””â”€â”€ students.wxss        # é¡µé¢æ ·å¼
```

### ç»„ä»¶æ–‡ä»¶ç»“æ„
```
components/student-card/
â”œâ”€â”€ student-card.js      # ç»„ä»¶é€»è¾‘
â”œâ”€â”€ student-card.json    # ç»„ä»¶é…ç½®
â”œâ”€â”€ student-card.wxml    # ç»„ä»¶ç»“æ„
â””â”€â”€ student-card.wxss    # ç»„ä»¶æ ·å¼
```

## ğŸ“ æ³¨é‡Šè§„èŒƒ

### æ–‡ä»¶å¤´æ³¨é‡Š
```javascript
/**
 * å­¦ç”Ÿæ•°æ®ç®¡ç†å·¥å…·
 * @description æä¾›å­¦ç”Ÿæ•°æ®çš„å¢åˆ æ”¹æŸ¥åŠŸèƒ½
 * @author å¼€å‘è€…å§“å
 * @date 2024-01-01
 * @version 1.0.0
 */
```

### å‡½æ•°æ³¨é‡Š
```javascript
/**
 * è·å–æŒ‡å®šæ ‡ç­¾çš„å­¦ç”Ÿåˆ—è¡¨
 * @param {string} tagId - æ ‡ç­¾ID
 * @param {Object} options - é€‰é¡¹å‚æ•°
 * @param {number} options.limit - é™åˆ¶æ•°é‡ï¼Œé»˜è®¤ä¸º10
 * @param {number} options.offset - åç§»é‡ï¼Œé»˜è®¤ä¸º0
 * @returns {Array<Object>} å­¦ç”Ÿåˆ—è¡¨
 * @throws {Error} å½“æ ‡ç­¾ä¸å­˜åœ¨æ—¶æŠ›å‡ºé”™è¯¯
 * @example
 * const students = getStudentsByTag('tag_001', { limit: 5 })
 */
function getStudentsByTag(tagId, options = {}) {
  // å®ç°é€»è¾‘
}
```

### å¤æ‚é€»è¾‘æ³¨é‡Š
```javascript
function calculateStudentStats(students) {
  // è®¡ç®—å­¦ç”Ÿç»Ÿè®¡æ•°æ®
  const stats = {
    total: students.length,
    active: 0,
    inactive: 0,
    avgProgress: 0
  }
  
  // éå†å­¦ç”Ÿæ•°æ®ï¼Œç»Ÿè®¡å„ç§çŠ¶æ€
  let totalProgress = 0
  students.forEach(student => {
    if (student.status === 'active') {
      stats.active++
    } else {
      stats.inactive++
    }
    totalProgress += student.progress || 0
  })
  
  // è®¡ç®—å¹³å‡è¿›åº¦ï¼Œé¿å…é™¤é›¶é”™è¯¯
  stats.avgProgress = students.length > 0 
    ? Math.round(totalProgress / students.length) 
    : 0
    
  return stats
}
```

## ğŸ”§ å·¥å…·é…ç½®

### ESLint é…ç½®
```json
{
  "env": {
    "es6": true,
    "node": true
  },
  "extends": ["eslint:recommended"],
  "parserOptions": {
    "ecmaVersion": 2020,
    "sourceType": "module"
  },
  "rules": {
    "indent": ["error", 2],
    "quotes": ["error", "single"],
    "semi": ["error", "never"],
    "no-console": "warn",
    "no-unused-vars": "error",
    "prefer-const": "error",
    "no-var": "error"
  },
  "globals": {
    "wx": "readonly",
    "App": "readonly",
    "Page": "readonly",
    "Component": "readonly",
    "getApp": "readonly"
  }
}
```

### Prettier é…ç½®
```json
{
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false,
  "semi": false,
  "singleQuote": true,
  "quoteProps": "as-needed",
  "trailingComma": "es5",
  "bracketSpacing": true,
  "arrowParens": "avoid"
}
```

## ğŸ“Š æ€§èƒ½è§„èŒƒ

### ä»£ç æ€§èƒ½
```javascript
// âœ… å¥½çš„åšæ³•ï¼šä½¿ç”¨é˜²æŠ–å¤„ç†æœç´¢
const searchStudents = debounce((keyword) => {
  const results = students.filter(s => 
    s.name.includes(keyword)
  )
  this.setData({ searchResults: results })
}, 300)

// âŒ é¿å…ï¼šé¢‘ç¹çš„ setData è°ƒç”¨
onSearchInput(e) {
  const keyword = e.detail.value
  // æ¯æ¬¡è¾“å…¥éƒ½ä¼šè§¦å‘ï¼Œæ€§èƒ½å·®
  this.setData({
    searchResults: students.filter(s => s.name.includes(keyword))
  })
}
```

### æ¸²æŸ“æ€§èƒ½
```xml
<!-- âœ… å¥½çš„åšæ³•ï¼šä½¿ç”¨ wx:if æ§åˆ¶æ¸²æŸ“ -->
<view wx:if="{{showStudentList}}" class="student-list">
  <view wx:for="{{students}}" wx:key="id">
    {{item.name}}
  </view>
</view>

<!-- âŒ é¿å…ï¼šä½¿ç”¨ hidden éšè—å¤§é‡å…ƒç´  -->
<view hidden="{{!showStudentList}}" class="student-list">
  <view wx:for="{{students}}" wx:key="id">
    {{item.name}}
  </view>
</view>
```

### å†…å­˜ç®¡ç†
```javascript
// âœ… å¥½çš„åšæ³•ï¼šåŠæ—¶æ¸…ç†å®šæ—¶å™¨å’Œç›‘å¬å™¨
onUnload() {
  if (this.timer) {
    clearInterval(this.timer)
    this.timer = null
  }
}

// âœ… å¥½çš„åšæ³•ï¼šé¿å…å†…å­˜æ³„æ¼
onShow() {
  this.loadData()
}

onHide() {
  // æ¸…ç†ä¸å¿…è¦çš„æ•°æ®
  this.setData({
    tempData: null
  })
}
```

## ğŸ§ª æµ‹è¯•è§„èŒƒ

### å•å…ƒæµ‹è¯•
```javascript
// utils/tag-utils.test.js
describe('TagUtils', () => {
  test('should create tag with correct properties', () => {
    const tagData = {
      name: 'ä¼˜ç§€å­¦ç”Ÿ',
      color: '#4CAF50',
      type: 'custom'
    }
    
    const tag = TagUtils.createTag(tagData)
    
    expect(tag.id).toBeDefined()
    expect(tag.name).toBe('ä¼˜ç§€å­¦ç”Ÿ')
    expect(tag.color).toBe('#4CAF50')
    expect(tag.createTime).toBeDefined()
  })
  
  test('should throw error for invalid tag data', () => {
    expect(() => {
      TagUtils.createTag({})
    }).toThrow('Tag name is required')
  })
})
```

### é¡µé¢æµ‹è¯•
```javascript
// pages/students/students.test.js
describe('Students Page', () => {
  let page
  
  beforeEach(() => {
    page = new StudentsPage()
    page.onLoad()
  })
  
  test('should load students on page load', () => {
    expect(page.data.students).toBeDefined()
    expect(Array.isArray(page.data.students)).toBe(true)
  })
  
  test('should filter students by search keyword', () => {
    page.onSearchInput({ detail: { value: 'å¼ ä¸‰' } })
    
    const filteredStudents = page.data.searchResults
    expect(filteredStudents.every(s => s.name.includes('å¼ ä¸‰'))).toBe(true)
  })
})
```

## ğŸ“‹ ä»£ç å®¡æŸ¥æ¸…å•

### åŠŸèƒ½æ£€æŸ¥
- [ ] åŠŸèƒ½æ˜¯å¦æŒ‰éœ€æ±‚å®ç°
- [ ] è¾¹ç•Œæ¡ä»¶æ˜¯å¦å¤„ç†
- [ ] é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„
- [ ] ç”¨æˆ·ä½“éªŒæ˜¯å¦å‹å¥½

### ä»£ç è´¨é‡æ£€æŸ¥
- [ ] ä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒ
- [ ] å˜é‡å‘½åæ˜¯å¦æ¸…æ™°
- [ ] å‡½æ•°æ˜¯å¦å•ä¸€èŒè´£
- [ ] æ˜¯å¦æœ‰é‡å¤ä»£ç 

### æ€§èƒ½æ£€æŸ¥
- [ ] æ˜¯å¦æœ‰æ€§èƒ½ç“¶é¢ˆ
- [ ] å†…å­˜ä½¿ç”¨æ˜¯å¦åˆç†
- [ ] æ˜¯å¦æœ‰ä¸å¿…è¦çš„æ¸²æŸ“
- [ ] æ•°æ®ç»“æ„æ˜¯å¦ä¼˜åŒ–

### å®‰å…¨æ£€æŸ¥
- [ ] è¾“å…¥æ•°æ®æ˜¯å¦éªŒè¯
- [ ] æ•æ„Ÿä¿¡æ¯æ˜¯å¦ä¿æŠ¤
- [ ] æƒé™æ§åˆ¶æ˜¯å¦æ­£ç¡®
- [ ] XSS é˜²æŠ¤æ˜¯å¦åˆ°ä½

## ğŸ“š æœ€ä½³å®è·µ

### æ•°æ®ç®¡ç†
```javascript
// âœ… ä½¿ç”¨ç»Ÿä¸€çš„æ•°æ®ç®¡ç†å™¨
class DataManager {
  static async getStudents() {
    try {
      const data = await StorageUtils.get(STORAGE_KEYS.STUDENTS)
      return data || []
    } catch (error) {
      console.error('è·å–å­¦ç”Ÿæ•°æ®å¤±è´¥:', error)
      return []
    }
  }
  
  static async saveStudents(students) {
    try {
      await StorageUtils.set(STORAGE_KEYS.STUDENTS, students)
      return { success: true }
    } catch (error) {
      return { success: false, error: error.message }
    }
  }
}
```

### ç»„ä»¶è®¾è®¡
```javascript
// âœ… ç»„ä»¶èŒè´£å•ä¸€ï¼Œæ¥å£æ¸…æ™°
Component({
  properties: {
    student: {
      type: Object,
      required: true
    },
    showTags: {
      type: Boolean,
      value: true
    }
  },
  
  methods: {
    onTap() {
      this.triggerEvent('tap', { student: this.data.student })
    }
  }
})
```

### é”™è¯¯å¤„ç†
```javascript
// âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
function handleError(error, context = '') {
  console.error(`${context}:`, error)
  
  wx.showToast({
    title: 'æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•',
    icon: 'none'
  })
  
  // ä¸ŠæŠ¥é”™è¯¯ä¿¡æ¯
  reportError(error, context)
}
```

è¿™äº›å¼€å‘è§„èŒƒå°†ç¡®ä¿ä»£ç è´¨é‡ã€å¯ç»´æŠ¤æ€§å’Œå›¢é˜Ÿåä½œæ•ˆç‡ã€‚æ‰€æœ‰å¼€å‘äººå‘˜éƒ½åº”ä¸¥æ ¼éµå¾ªè¿™äº›è§„èŒƒã€‚